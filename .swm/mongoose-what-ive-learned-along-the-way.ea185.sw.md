---
id: ea185
title: Mongoose-What I've learned along the way
file_version: 1.1.1
app_version: 1.0.15
---

# Model methods

## Model.`findOneAndUpdate`<swm-token data-swm-token=":src/services/auth.service.ts:26:11:11:`        const user = await User.findOneAndUpdate(`"/>

<br/>

*   the first param represents the query
    
*   the second is the data you want to update
    
*   the third param is options along with the update function
    
    *   `new`<swm-token data-swm-token=":src/services/auth.service.ts:29:3:3:`            { new: true, runValidators: true }`"/>: return the updated document
        
    *   `runValidators`<swm-token data-swm-token=":src/services/auth.service.ts:29:9:9:`            { new: true, runValidators: true }`"/>: run model validations when saving the new data
<!-- NOTE-swimm-snippet: the lines below link your snippet to Swimm -->
### ðŸ“„ src/services/auth.service.ts
```typescript
26             const user = await User.findOneAndUpdate(
27                 { email },
28                 { verificationToken },
29                 { new: true, runValidators: true }
30             )
```

<br/>

`$set`<swm-token data-swm-token=":src/services/board.service.ts:72:3:4:`                { $set: { cards: list.cards } }`"/> means you can set a specific field to a value
<!-- NOTE-swimm-snippet: the lines below link your snippet to Swimm -->
### ðŸ“„ src/services/board.service.ts
```typescript
70                 await List.findOneAndUpdate(
71                     { _id: list.id },
72                     { $set: { cards: list.cards } }
73                 )
```

<br/>

`$pull`<swm-token data-swm-token=":src/services/card.service.ts:89:1:2:`            $pull: { cards: cardId },`"/> means take out a value from a field. In this particular example means taking the `cardId`<swm-token data-swm-token=":src/services/card.service.ts:89:10:10:`            $pull: { cards: cardId },`"/> off the cards field.
<!-- NOTE-swimm-snippet: the lines below link your snippet to Swimm -->
### ðŸ“„ src/services/card.service.ts
```typescript
86         const list = await List.findOneAndUpdate(
87             { cards: cardId },
88             {
89                 $pull: { cards: cardId },
90             },
91             { new: true }
92         )
```

<br/>

<br/>

## Document.`populate`<swm-token data-swm-token=":src/services/board.service.ts:34:2:2:`        .populate({`"/>

<br/>

Sometimes you have an array of ids in your model which is quite a normal approach. And you want to send back not only the ids but also other documents with these ids.

These `path`<swm-token data-swm-token=":src/services/board.service.ts:35:1:1:`            path: &#39;lists&#39;,`"/> specify which field you would like to populate other documents and `select`<swm-token data-swm-token=":src/services/board.service.ts:36:1:1:`            select: &#39;id cards&#39;,`"/> represents the fields you want to include (or exclude by using the '-' symbol).

In this code snippet. This function will return all the Board documents with lists and members populated with some fields of their own.

<!-- empty line --><br/>
<!-- NOTE-swimm-snippet: the lines below link your snippet to Swimm -->
### ðŸ“„ src/services/board.service.ts
```typescript
33         const boards = await Board.find()
34             .populate({
35                 path: 'lists',
36                 select: 'id cards',
37             })
38             .populate({
39                 path: 'members',
40                 select: 'id name',
41             })
```

<br/>

You can even use populate in a populate like this. This will populate card documents within lists.
<!-- NOTE-swimm-snippet: the lines below link your snippet to Swimm -->
### ðŸ“„ src/services/card.service.ts
```typescript
44         const board = await Board.findOne({ _id: boardId }).populate({
45             path: 'lists',
46             select: 'id',
47             populate: 'cards',
48         })
```

<br/>

<br/>

<br/>

This file was generated by Swimm. [Click here to view it in the app](https://app.swimm.io/repos/Z2l0aHViJTNBJTNBc2NydW0tdHJhY2tlci1iZSUzQSUzQWx1bGlhbjY2Ng==/docs/ea185).
